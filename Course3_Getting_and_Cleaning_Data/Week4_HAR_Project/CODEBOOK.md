#Codebook

## Background

The dataset to be processed comes from a study that uses a SmartPhone
to detect and quantify motion of a human body.

###How to describe the motion of a human body ?
Any motion of a human body can be broken down into translation
and rotation. Of course, we can move our fingers without
translating or rotating our entire body. So that is not very useful
for whole body motion.

###How can a SmartPhone detect motion ?
Some (or maybe all) SmartPhones contain accelerometers and gyroscopes.
Accelerometers measure our acceleration along the three axes of some
pre-defined Cartesian coordinate frame. Gyroscopes on the other hand
measure our rate of rotation (angular velocity) with respect to the coordinate 
frame. Together, the Accelerometer and Gyroscope can measure human body 
motion. By wearing a SmartPhone on the waist, changes such as finger movement
not associated with translation or rotation of the body can be ignored.

###What is actually measured ?
When we move, our acceleration and angular velocity changes with time. 
The series of measurements generated by the Accelerometer(for acceleration)
and Gyroscope (for angular velocity) as a human body moves takes the form 
of a time series. To see what such a time series looks like, see Figure 2 
of the following manuscript which shows the three components of acceleration 
change with time during a walk or climbing stairs. 
(http://www.jucs.org/jucs_19_9/energy_efficient_smartphone_based/jucs_19_09_1295_1314_anguita.pdf)

###Which information (or features) can be extracted from any time series?
First note that in Figure 2 of the pdf file referred to above, the time
series appears to show some regular motion and some noise. To make sense
of any time series, typically some filtering is performed in order to
minimize the contribution of noise to the signal. 

Once the time series has been filtered, a number of features of the resulting
time series can be extracted. Table 3 of the following pdf file
(https://www.elen.ucl.ac.be/Proceedings/esann/esannpdf/es2013-84.pdf)
lists the features as

Features and their Description
* mean  - Mean value
* std  - Standard deviation
* mad  - Median absolute value
* max  - Largest values in array
* min  - Smallest value in array
* sma  - Signal magnitude area
* energy - Average sum of the squares 
* iqr  - Interquartile range
* entropy  - Signal Entropy
* arCoeff  - Autorregresion coefficients
* correlation - Correlation coefficient
* maxFreqInd  - Largest frequency component
* meanFreq - Frequency signal weighted average
* skewness - Frequency signal Skewness
* kurtosis  - Frequency signal Kurtosis
* energyBand - Energy of a frequency interval
* angle - Angle between two vectors

Note that 
* the energy variable does not refer to the more familiar example of
energy. To understand its meaning/interpretation, refer to the Wikipedia 
page for "Spectral Density"
* Several features are vectors and they have X, Y, Z components

###What about the frequency domain ?
A Fourier transform can convert a time-domain signal (time series) to a
frequency domain signal. Just as for the time domain above, several features can
be extracted. In addition, for the frequency domain, bandsEnergy can be calculated.

###What about rate of change of acceleration or angular momentum ?
Another aspect of the data is the rate of change of acceleration, also
known as Jerk. Just as for any time series, features from the Jerk time series
can also be extracted and used a features. Similar to acceleration, an angular Jerk
can be calculated as the second derivative of the angular velocity.

### Components of the Accelerometer output
The accelerometer signal contains, besides noise, a Gravitational component and
a Body motion component. 

### What to do with the time and frequency domain features ? aka Objective
As you may have noticed if you saw Figure 2 in the pdf file above, different 
activities lead to different time variation of the measurements. Consequently,
there are differences in the time and frequency domain summary features.
So, based on the available features and the corresponding activity, a question 
that one may ask is "Given a new set of features, can we use this information to 
predict which activity they correspond to ? In other words, can one
predict the type of motion a human body is undergoing from the corresponding
measurements output by the accelerometer and gyroscope ? 


##Project Objective

You should create one R script called run_analysis.R that does the following.

1. Merges the training and the test sets to create one data set.
2. Extracts only the measurements on the mean and standard deviation for each measurement.
3. Uses descriptive activity names to name the activities in the data set
4. Appropriately labels the data set with descriptive variable names.
5. From the data set in step 4, creates a second, independent tidy data set with the 
   average of each variable for each activity and each subject.


##Description of the variables

From Anguita et al, Journal of Universal Computer Science, vol. 19, no. 9 (2013), 1295-1314

"A set of trials with volunteers was required to create and develop the human
activity recognition dataset. In total, 30 people with ages from 19 to 48 years
participated in this research and performed a set of motion sequences comprising
the 6 proposed ADL (standing, sitting, laying, walking, walking upstairs and
walking downstairs). Each subject performed the experiment protocol twice,
and each activity was at least performed two times on each trial to simulate
repeatability (refer to Table 1 for further details)"

Here, I summarize the name of variables that are used to define features
along with whether time or frequency domain features are summarized.
Frequency domain variables are obtained by Fourier transforming the time
series. The interpretation of selected variables follows from Table 2 in 
https://www.elen.ucl.ac.be/Proceedings/esann/esannpdf/es2013-84.pdf. I
summarize it here as the following

* BodyAcc         - Body Frame Acceleration Vector (tBodyAcc and fBodyAcc) 
* BodyAccJerk     - Body Frame Jerk Vector (tBodyAccJerk and fBodyAccJerk) 
* BodyAccMag      - Body Frame Magnitude of Acceleration (tBodyAccMag and fBodyAccMag)
* BodyAccJerkMag  - Body Frame Magnitude of Jerk (tBodyAccJerkMag and fBodyAccJerkMag)
* GravityAcc      - Gravitational Acceleration vector (tGravityAcc)
* GravityAccMag   - Magnitude of Gravitational Acceleration (tGravityAccMag)
* BodyGyro        - Body Angular velocity vector (tBodyGyro and fBodyGyro)
* BodyGyroJerk    - Body Angular Acceleration vector (tBodyGyroJerk)
* BodyGyroMag     - Magnitude of Body Angular Velocity (tBodyGyroMag and fBodyGyroMag)
* BodyGyroJerkMag - Magnitude of Body Angular Acceleration (tBodyGyroJerkMag and fBodyGyroJerkMag)

These add up to 17 different time and frequency domain variables.
Of these 17 variables, except for the variable ending in Mag, all are vectors with
X, Y and Z components.

For each variable, a number of statistical data is calculated and labeled. 
* mean() - Mean value
* std() - Standard deviation
* mad() - Median absolute deviation 
* max() - Largest value in array
* min() - Smallest value in array
* sma() - Signal magnitude area
* energy() - Energy measure. Sum of the squares divided by the number of values. 
* iqr() - Interquartile range 
* entropy() - Signal entropy
* arCoeff() - Autorregresion coefficients with Burg order equal to 4
* correlation() - correlation coefficient between two signals
* maxInds() - index of the frequency component with largest magnitude
* meanFreq() - Weighted average of the frequency components to obtain a mean frequency
* skewness() - skewness of the frequency domain signal 
* kurtosis() - kurtosis of the frequency domain signal 
* bandsEnergy() - Energy of a frequency interval within the 64 bins of the FFT of each window.
* angle() - Angle between two vectors.

For each of the 17 different time or frequency domain variables, several of the
statistical features listed above were included in the data for further analysis.

Another set of attributes correspond to angles between selected vectors and directions.

## Description of the data

The data is split into two sets, one for training and one for testing (the machine
learning algorithm) each set containing three files

* train:
  + X_train - 7352 measurements, each with 561 features
  + y_train - 7352 rows, each with one activity, labels from 1 to 6
  + subject_train - 7352 rows, each for one of the 30 subject
  + Inertial Signals - raw data
* test
  + X_test - 2947 measurements, each with 561 features
  + y_test - 2947 rows, each with one activity, labels from 1 to 6
  + subject_test - 2947 rows, each for one of the 30 subject
  + Inertial Signals - raw data
* activity_labels - integer index for referring to each of the 6 activities
* features.txt - list of 561 feature names
* feature_info.txt - brief summary of signal processing and feature extraction

## Data manipulation for the Project
### Task 1: Merge the training and test sets to create one data set
* Step 1: Data collection with the function download_data()
          +Download data from the website 
	  +unzip it 
* Step 2: Read feature names from feaures.txt with the function read_feature_list()
* Step 3: Assign name of input data files to variables with functions assign_input_filenames1()
          and assign_input_filenames2()
* Step 4: Assemble train data table with the function assemble_training_data(). 
          + Stage 1: Read data table from X_train.txt and assign feature names to it.
	  + Stage 2: Reads activity data from y_train.txt and assigns it the columm name "Activity". 
	  + Stage 3: Read subject data from subject_train.txt and assign it the column name "Subject".
	  + Stage 4: Merge Subject_train.txt, y_train.txt and X_train.txt into one table with bind_cols()
	  Training data table has 7352 rows and 563 columns
* Step 5: Assemble test data table with the function assemble_testing_data(). 
          + Stage 1: Read data table from X_test.txt and assign feature names to it.
	  + Stage 2: Reads activity data from y_test.txt and assigns it the columm name "Activity". 
	  + Stage 3: Read subject data from subject_test.txt and assign it the column name "Subject".
	  + Stage 4: Merge the tables for subject_test.txt, y_test.txt and X_test.txt into one table 
	             with bind_cols()
	  Test data table has 2947 rows and 563 columns
* Step 6: Merge training and testing data with the function merge_train_test_data()
          Append the test data table to the end of the train data table with rbind() 
	  and construct the full dataset (full_dataset) with 10299 rows and 561 columns

### Task 2: Extract only mean and standard deviation data with the function make_subset_data()
* Step 1: Save the activity and subject columns (cols 1 and 2) in in array list0
* Step 2: Use grep to construct list of column indices (list2) with "mean" in them. For 
          simplicity, all column names with "mean" in them are selected. To select the columns 
	  with names that contain mean(), just grep for mean\\(\\) instead. For simplicity, 
	  "mean" is used.
* Step 3: Use grep to construct list of column indices (list3) with "std" in them. 
* Step 4: Append list3 to list2, and sort indices. Append the resulting list to list0 to get sorted_list
* Step 5: Add name of all columns with indices in sorted_list to the array selected_columns
* Step 6: Construct a new table containing only columns with names in selected_columns
          The resulting data table, shortlist_dataset, has 10299 rows and 81 columns

### Task 3: Name activities with descriptive names
* Step 1: Reassign column 2 in shortlist_dataset as factors.
* Step 2: Construct character array with new activity labels.
* Step 3: Assign new activity label array as new levels of the factor.

### Task 4: Rename columns with more descriptive labels using function transform_colnames3()
* Step 1. Construct list of strings to be transformed
* Step 2. Construct list of strings that will replace the strings to be transformed in Step 1
* Step 3. Iteratively substitute new strings with original strings.

The primary variable name transformations are
* BodyAccJerkMag -> Magnitude.Body.Jerk.
* BodyAccMag -> Magnitude.Body.Acceleration.
* BodyAccJerk -> Body.Jerk.
* BodyAcc -> Body.Acceleration.
* GravityAccMag -> Magnitude.Gravity.Acceleration.
* GravityAcc -> Gravity.Acceleration.
* BodyGyroJerkMag -> Magnitude.Angular.Acceleration.
* BodyGyroMag -> Magnitude.Angular.Velocity.
* BodyGyroJerk -> Body.Angular.Acceleration.
* BodyGyro -> Body.Angular.Velocity.

The secondary variable name transformations are
* BodyBody -> Body
* "()" -> ""
* t at beginning of name -> Time.Domain.
* f at begining of name -> Frequency.Domain.
* "-" -> "."

The resulting variable names are
* Activity - Which activity the data corresponds to
* Subject - Which subject the data is for
* Time.Domain.Body.Acceleration.mean.X - Mean X-component of acceleration in body frame
* Time.Domain.Body.Acceleration.mean.Y - Mean Y-component of acceleration in body frame
* Time.Domain.Body.Acceleration.mean.Z - Mean Z-component of acceleration in body frame
* Time.Domain.Body.Acceleration.std.X - Standard deviation of X-component of acceleration in body frame
* Time.Domain.Body.Acceleration.std.Y - Standard deviation of Y-component of acceleration in body frame
* Time.Domain.Body.Acceleration.std.Z - Standard deviation of Z-component of acceleration in body frame
* Time.Domain.Gravity.Acceleration.mean.X - Mean X-component of gravitational contribution to acceleration
* Time.Domain.Gravity.Acceleration.mean.Y - Mean Y-component of gravitational contribution to acceleration
* Time.Domain.Gravity.Acceleration.mean.Z - Mean Z-component of gravitational contribution to acceleration
* Time.Domain.Gravity.Acceleration.std.X - Standard Deviation of X-component of gravitational contribution to acceleration
* Time.Domain.Gravity.Acceleration.std.Y - Standard Deviation of Y-component of gravitational contribution to acceleration
* Time.Domain.Gravity.Acceleration.std.Z - Standard Deviation of Z-component of gravitational contribution to acceleration
* Time.Domain.Body.Jerk.mean.X - Mean X-component of Jerk in body frame
* Time.Domain.Body.Jerk.mean.Y - Mean Y-component of Jerk in body frame
* Time.Domain.Body.Jerk.mean.Z - Mean Z-component of Jerk in body frame
* Time.Domain.Body.Jerk.std.X - Standard Deviation of X-component of Jerk in body frame
* Time.Domain.Body.Jerk.std.Y - Standard Deviation of Y-component of Jerk in body frame
* Time.Domain.Body.Jerk.std.Z - Standard Deviation of Z-component of Jerk in body frame
* Time.Domain.Body.Angular.Velocity.mean.X - Mean of angular velocity about X-axis in body frame
* Time.Domain.Body.Angular.Velocity.mean.Y - Mean of angular velocity about Y-axis in body frame
* Time.Domain.Body.Angular.Velocity.mean.Z - Mean of angular velocity about Z-axis in body frame
* Time.Domain.Body.Angular.Velocity.std.X - Standard Deviation of angular velocity about X-axis in body frame
* Time.Domain.Body.Angular.Velocity.std.Y - Standard Deviation of angular velocity about Y-axis in body frame
* Time.Domain.Body.Angular.Velocity.std.Z - Standard Deviation of angular velocity about Z-axis in body frame
* Time.Domain.Body.Angular.Acceleration.mean.X - Mean of Angular Acceleration about X-axis in body frame
* Time.Domain.Body.Angular.Acceleration.mean.Y - Mean of Angular Acceleration about Y-axis in body frame
* Time.Domain.Body.Angular.Acceleration.mean.Z - Mean of Angular Acceleration about Z-axis in body frame
* Time.Domain.Body.Angular.Acceleration.std.X - Standard Deviation of Angular Acceleration about X-axis in body frame 
* Time.Domain.Body.Angular.Acceleration.std.Y - Standard Deviation of Angular Acceleration about Y-axis in body frame
* Time.Domain.Body.Angular.Acceleration.std.Z - Standard Deviation of Angular Acceleration about Z-axis in body frame
* Time.Domain.Magnitude.Body.Acceleration.mean - Mean of magnitude of body acceleration
* Time.Domain.Magnitude.Body.Acceleration.std - Standard deviation of magnitude of body acceleration
* Time.Domain.Magnitude.Gravity.Acceleration.mean - Mean magnitude of gravitational acceleration
* Time.Domain.Magnitude.Gravity.Acceleration.std - Standard deviation of magnitude of gravitational acceleration
* Time.Domain.Magnitude.Body.Jerk.mean - Mean magnitude of Jerk in the body frame
* Time.Domain.Magnitude.Body.Jerk.std - Standard deviation of Jerk in the body frame
* Time.Domain.Magnitude.Angular.Velocity.mean - Mean of the magnitude of angular velocity
* Time.Domain.Magnitude.Angular.Velocity.std - Standard deviation of the magnitude of angular velocity
* Time.Domain.Magnitude.Body.Angular.Acceleration.mean - Mean of the magnitude of angular acceleration
* Time.Domain.Magnitude.Body.Angular.Acceleration.std - Standard deviation of the magnitude of angular acceleration
* Frequency.Domain.Body.Acceleration.mean.X - mean of the X-component of acceleration in body frame in frequency domain
* Frequency.Domain.Body.Acceleration.mean.Y - mean of the Y-component of acceleration in body frame in frequency domain
* Frequency.Domain.Body.Acceleration.mean.Z - mean of the Z-component of acceleration in body frame in frequency domain
* Frequency.Domain.Body.Acceleration.std.X - standard deviation of the X-component of acceleration in body frame in frequency domain
* Frequency.Domain.Body.Acceleration.std.Y - standard deviation of the Y-component of acceleration in body frame in frequency domain
* Frequency.Domain.Body.Acceleration.std.Z - standard deviation of the Z-component of acceleration in body frame in frequency domain
* Frequency.Domain.Body.Acceleration.meanFreq.X - X-component of the frequency signal weighted average of acceleration in body frame
* Frequency.Domain.Body.Acceleration.meanFreq.Y - Y-component of the frequency signal weighted average of acceleration in body frame
* Frequency.Domain.Body.Acceleration.meanFreq.Z - Z-component of the frequency signal weighted average of acceleration in body frame
* Frequency.Domain.Body.Jerk.mean.X - mean of the X-component of Body Jerk in frequency domain
* Frequency.Domain.Body.Jerk.mean.Y - mean of the Y-component of Body Jerk in frequency domain
* Frequency.Domain.Body.Jerk.mean.Z - mean of the Z-component of Body Jerk in frequency domain
* Frequency.Domain.Body.Jerk.std.X - standard deviation of the X-component of body jerk in frequency domain
* Frequency.Domain.Body.Jerk.std.Y - standard deviation of the Y-component of body jerk in frequency domain
* Frequency.Domain.Body.Jerk.std.Z - standard deviation of the Z-component of body jerk in frequency domain
* Frequency.Domain.Body.Jerk.meanFreq.X - X-component of the frequency signal weighted average of body jerk in frequency domain
* Frequency.Domain.Body.Jerk.meanFreq.Y - Y-component of the frequency signal weighted average of body jerk in frequency domain
* Frequency.Domain.Body.Jerk.meanFreq.Z - Z-component of the frequency signal weighted average of body jerk in frequency domain
* Frequency.Domain.Body.Angular.Velocity.mean.X - mean angular velocity about the X-axis in body frame in frequency domain
* Frequency.Domain.Body.Angular.Velocity.mean.Y - mean angular velocity about the Y-axis in body frame in frequency domain
* Frequency.Domain.Body.Angular.Velocity.mean.Z - mean angular velocity about the Z-axis in body frame in frequency domain
* Frequency.Domain.Body.Angular.Velocity.std.X - standard deviation of angular velocity about the X-axis in body frame in frequency domain
* Frequency.Domain.Body.Angular.Velocity.std.Y - standard deviation of angular velocity about the Y-axis in body frame in frequency domain
* Frequency.Domain.Body.Angular.Velocity.std.Z - standard deviation of angular velocity about the Z-axis in body frame in frequency domain
* Frequency.Domain.Body.Angular.Velocity.meanFreq.X - mean of X-component of frequency signal weighted average angular velocity in body frame
* Frequency.Domain.Body.Angular.Velocity.meanFreq.Y - mean of Y-component of frequency signal weighted average angular velocity in body frame
* Frequency.Domain.Body.Angular.Velocity.meanFreq.Z - mean of Z-component of frequency signal weighted average angular velocity in body frame
* Frequency.Domain.Magnitude.Body.Acceleration.mean - mean of magnitude of body acceleration in frequency domain
* Frequency.Domain.Magnitude.Body.Acceleration.std - standard deviation of magnitude of body acceleration in frequency domain
* Frequency.Domain.Magnitude.Body.Acceleration.meanFreq - frequency signal weighted average body acceleration in frequency domain
* Frequency.Domain.Magnitude.Body.Jerk.mean - mean of the magnitude of body jerk in frequency domainl
* Frequency.Domain.Magnitude.Body.Jerk.std - standard deviation of the magnitude of body jerk in frequency domain
* Frequency.Domain.Magnitude.Body.Jerk.meanFreq - frequency signal weighted average body jerk in frequency domain
* Frequency.Domain.Magnitude.Angular.Velocity.mean - mean of the magnitude of angular velocity in frequency domain
* Frequency.Domain.Magnitude.Angular.Velocity.std - standard deviation of the magnitude of angular velocity in frequency domain
* Frequency.Domain.Magnitude.Angular.Velocity.meanFreq - frequency signal weighted average of the magnitude of angular velocity in frequency domain
* Frequency.Domain.Magnitude.Body.Angular.Acceleration.mean - mean of frequency signal weighted mean of angular acceleration in frequency domain
* Frequency.Domain.Magnitude.Body.Angular.Acceleration.std - standard deviation of frequency signal weighted mean of angular acceleration in frequency domain
* Frequency.Domain.Magnitude.Body.Angular.Acceleration.meanFreq - frequency signal weighted average of the angular acceleration in frequency domain


### Task 5: Create a tidy dataset with average values for each variable for each activity and for each subject
This task was performed by grouping the data by the activity and subject, followed by calculating the mean.
The resulting dataset was saved in the file tidydata.txt
